<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ğŸ› ï¸ çµ„åˆå±‹ææ–™æ¸…å–®å°ç…§è¡¨</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Microsoft JhengHei', Arial, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .container { max-width: 1600px; margin: 0 auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 28px; }
        .toolbar { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        button { padding: 12px 20px; border: none; border-radius: 8px; background: #667eea; color: white; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .add-row { background: #51cf66; }
        .add-col { background: #f093fb; }
        .export { background: #f5576c; }
        .print { background: #4facfe; }
        .clear { background: #ff6b6b; }
        table { border-collapse: collapse; width: 100%; font-size: 13px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        th, td { border: 2px solid #dee2e6; padding: 12px 8px; min-height: 45px; text-align: center; position: relative; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important; color: white; font-weight: bold; position: sticky; top: 0; z-index: 10; }
        td[contenteditable="true"], th[contenteditable="true"] { background: white; cursor: text; }
        td:focus, th:focus { outline: 3px solid #4facfe; background: #fff !important; transform: scale(1.01); }
        .item { background: #f8f9fa !important; font-weight: 500; text-align: left; padding-left: 15px; }
        .delete-btn { position: absolute; top: 2px; right: 2px; width: 24px; height: 24px; border-radius: 50%; background: #ff6b6b; color: white; border: none; font-size: 14px; cursor: pointer; display: none; line-height: 24px; }
        tr:hover .delete-btn { display: block; }
        .notes { background: #fff3cd !important; font-size: 12px; }
        @media print { .toolbar, .delete-btn { display: none !important; } }
    </style>
</head>
<body>
    <div class="container">
        <h1 contenteditable="true">ğŸ› ï¸ çµ„åˆå±‹ææ–™æ¸…å–®å°ç…§è¡¨</h1>
        <div class="toolbar">
            <button class="add-row" onclick="addRow()">â• æ–°å¢ææ–™é …ç›®</button>
            <button class="add-col" onclick="addColumn()">â• æ–°å¢å°ºå¯¸æ¬„</button>
            <button class="export" onclick="exportExcel()">ğŸ“Š åŒ¯å‡ºExcel</button>
            <button class="print" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°</button>
            <button class="clear" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰å…§å®¹</button>
        </div>
        
        <table id="materialsTable">
            <thead>
                <tr>
                    <th contenteditable="true">ææ–™é …ç›®</th>
                    <th contenteditable="true">3x5ç±³</th>
                    <th contenteditable="true">3x6ç±³</th>
                    <th contenteditable="true">3x7ç±³</th>
                    <th contenteditable="true">3x8ç±³</th>
                    <th contenteditable="true">4x5ç±³</th>
                    <th contenteditable="true">4x6ç±³</th>
                    <th contenteditable="true">4x7ç±³</th>
                    <th contenteditable="true">4x8ç±³</th>
                    <th contenteditable="true">5x5ç±³</th>                    
                    <th contenteditable="true">5x6ç±³</th>
                    <th contenteditable="true">5x7ç±³</th>
                    <th contenteditable="true">5x8ç±³</th>
                    <th style="background:#ff6b6b;">åˆªé™¤</th>
                </tr>
            </thead>
            <tbody>
                <tr><td class="item" contenteditable="true">åœ°æ¿</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">åº«ç‰ˆ</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">åœ°æ¿æ”¯æ¶</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">å¤©èŠ±æ¿ä¸»æ”¯æ¶</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">å¤©èŠ±æ¿æ”¯æ¶ç²—</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">å¤©èŠ±æ¿æ”¯æ¶ç´°</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">çŸ­é‚Š3ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">çŸ­é‚Š4ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">çŸ­é‚Š5ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">é•·é‚Š6ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">é•·é‚Š7ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">é•·é‚Š8ç±³æ¨‘çµ„ï¼ˆä¸Š+ä¸‹ï¼‰</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">ç«‹æŸ±æ¯é–“4éš»</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">è§’åº§æ¯é–“8é¡†</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="item" contenteditable="true">çŸ­é‚Š3ç±³æ‰£å¸ƒæ¯é–“2éš»</td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td></tr>
                <tr><td class="
